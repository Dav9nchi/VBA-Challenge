Sub StocksYearlySummarize()
    Dim ws As Worksheet
    Dim Ticker As String
    Dim Yearly_change As Double
    Dim Percentage_change As Double
    Dim Tot_Stock_Vol As Double
    Dim OpenRow As Double
    Dim CloseRow As Double
    Dim G_porc_increase As Double
    Dim G_porc_decrease As Double
    Dim G_Vol As Double
    Dim G_increase_ticker As String
    Dim G_decrease_ticker As String
    Dim G_Ticker_Vol As String
    Dim j As Long

    For Each ws In Worksheets
        Dim LastRow As Long
        Dim i As Long

        ws.Cells(1, 9).Value = "Ticker"
        ws.Cells(1, 10).Value = "Yearly change"
        ws.Cells(1, 11).Value = "Percent change"
        ws.Cells(1, 12).Value = "Tot Stock Vol"
        ws.Cells(1, 16).Value = "Ticker"
        ws.Cells(1, 17).Value = "Value"
        ws.Cells(4, 15).Value = "Greatest Total Volume"
        ws.Cells(3, 15).Value = "Greatest % Decrease"
        ws.Cells(2, 15).Value = "Greatest % Increase"

        G_porc_increase = 0
        G_porc_decrease = 0
        G_Vol = 0
        G_increase_ticker = ""
        G_decrease_ticker = ""
        G_Ticker_Vol = ""

        ws.Cells(4, 16).Value = G_Ticker_Vol
        ws.Cells(3, 16).Value = G_decrease_ticker
        ws.Cells(2, 16).Value = G_increase_ticker

        OpenRow = ws.Cells(2, 3).Value
        Tot_Stock_Vol = 0
        j = 2

        LastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row

        For i = 2 To LastRow
            Ticker = ws.Cells(j, 1).Value

            If Ticker <> ws.Cells(i + 1, 1).Value Then
                CloseRow = ws.Cells(i - 1, 6).Value
                Yearly_change = CloseRow - OpenRow

                ws.Cells(j, 9).Value = Ticker
                ws.Cells(j, 10).Value = Yearly_change
                ws.Cells(j, 12).Value = Tot_Stock_Vol
                
             Else: OpenRow = ws.Cells(i, 3).Value
                Tot_Stock_Vol = 0
                j = j + 1
            End If
                Tot_Stock_Vol = Tot_Stock_Vol + ws.Cells(i, 7).Value

                ' Yearly Change Colors '
                If Yearly_change >= 0 Then
                    ws.Cells(j, 10).Interior.Color = vbGreen
                Else
                    ws.Cells(j, 10).Interior.Color = vbRed
                End If

                ' Percentage Calculation '
                If OpenRow <> 0 Then
                    Percentage_change = (Yearly_change / OpenRow)
                    ws.Cells(j, 11).Value = Format(Percentage_change, "Percent")
                Else
                    ws.Cells(j, 11).Value = Format(0, "Percent")
                End If

                ' Check Greatest Increase-Decrease & Volume'
                If Percentage_change > G_porc_increase Then
                        G_porc_increase = Percentage_change
                        G_increase_ticker = Ticker
                ElseIf Percentage_change < G_porc_decrease Then
                        G_porc_decrease = Percentage_change
                        G_decrease_ticker = Ticker
                End If

                If Tot_Stock_Vol > G_Vol Then
                    G_Vol = Tot_Stock_Vol
                    G_Ticker_Vol = Ticker
                End If
           
        Next i

        ' Print the greatest results for the current worksheet
        ws.Cells(2, 16).Value = G_increase_ticker
        ws.Cells(3, 16).Value = G_decrease_ticker
        ws.Cells(4, 16).Value = G_Ticker_Vol
    Next ws
End Sub
